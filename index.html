<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icon.png" type="image/png"/>
    <title>Wordle Game</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&icon_names=backspace,keyboard_return" />
    <style>
        .toast{
            position: absolute;
            top: 5%;
            border-radius: 40px;
            box-shadow: 0px 0px 10px white;
            width: 20%;
            height: 7%;
            background-color: white;
            display: none;
            font-size: 30px;
            text-align: center;
            padding-top: 30px;
        }
        input{
            display: none;
        }
        html,body{
            width: 100%;
            height: 100%;
            margin: 0;
            font-size: 70px;
            font-family: "Gill Sans", sans-serif;
            color: white;
            background-color: rgb(0, 44, 95);
        }
        .sentence{
                padding-bottom: 10px;
        }
        main{
            display: flex;
            width: 100%;
            justify-content: center;
            height: 100%;
            align-items:  flex-start;
        }
        ul{
            list-style-type:  none;
            padding: 0;
            margin: 20px 0 0 0;
        }
        li{
            max-height: 5vw;
            margin-bottom: 20px;
        }
        .attempt{
            text-decoration: none;
            display: block;
            margin:0;
        }
        .letter{
            font-size: 3vw;
            width: 3vw;
            height: 3vw;
            border: 2px black solid;
            border-radius: 10px;
            display: inline-block;
        }
        .keyletter{
            font-size: 2vw;
            width: 2vw;
            height: 2vw;
            border: 2px black solid;
            border-radius: 10px;
            display: inline-block;
            text-align: center;
            margin-right: 2px;
            cursor: pointer;
            background-color: rgb(35, 149, 255);
            color :white;
        }
        .keyboard{
            width: 21vw;
        }
        @media (max-width: 600px) {
            .sentence{font-size: 40px;}
           .letter{width: 10vw;height: 10vw;font-size: 9vw;}
           li{
            max-height: 10vw;
           }
           .attempt{margin-bottom: 20px;}
           .keyletter{width: 10vw;height: 10vw;font-size: 9vw;}
           .keyboard{
                width: 80vw;
            }
            .toast{
                width: 80%;
            }
            }
    </style>
</head>
<body>
    
    <script>
        var random = "";
        var win = false;
        var randomSet = new Set();
        fetch("https://wordle.pythonanywhere.com/random").then(r=>{return r.text()}).then(r=>{
            console.log(r);
            random = r
            for(let i = 0;i<r.length;i++)
            {
                randomSet.add(r.charAt(i)) ; 
            }
        })
        var index=0;
    </script>
    <main>
        <div class="toast"></div>
        <ul> 
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="attempt">
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
                <div class="letter"></div>
            </li>
            <li class="keyboard">
                <script>
                    const keyboardLayout=["QWERTYUIOP","ASDFGHJKL","ZXCVBNM"];
                    for(let row of keyboardLayout){
                        for(let char of row){
                            document.write(`<div class="keyletter">${char}</div>`);
                        }
                    }
                </script>
                <div class="keyletter" style="background-color: rgb(236, 0, 0);"><span class="material-symbols-outlined">backspace</span></div>
                <div class="keyletter" style="background-color: rgb(0, 219, 66);"><span class="material-symbols-outlined">keyboard_return</span></div>
            </li>
        </ul>
    </main>
    <script>
        var word = "";
        var letter = document.querySelectorAll(".letter")
        var letters = document.querySelectorAll(".keyletter");
            letters.forEach(function(element) {
                element.addEventListener("click",(e)=>{
                    if(index>5 || win===true)
                        return;
                    let w = e.target.innerText
                    if(w==="backspace" && word.length>0)
                    {
                        letter[(5*index)+word.length-1].innerHTML = "";
                        word = word.slice(0,-1);
                    }
                    else if(w==="keyboard_return" && word.length==5)
                    {
                        console.log(word);
                        fetch("https://wordle.pythonanywhere.com/get?word="+word.toLowerCase()).then(r=>{return r.text()}).then(r=>{
                            console.log(r);
                            if(r==="True")
                            {
                                var y = 0;
                                var correct = 0;
                                var interval = setInterval(()=>{
                                    if(word.charAt(y).toLowerCase()===random.charAt(y))
                                    {
                                        letter[(5*index)+y].style.backgroundColor = "#047727";
                                        correct++;
                                    }
                                    else if(randomSet.has(word.charAt(y).toLowerCase()))
                                    {
                                        letter[(5*index)+y].style.backgroundColor = "#dfc801";
                                    }
                                    else
                                    {
                                        letter[(5*index)+y].style.backgroundColor = "#888888";
                                    }
                                    if(++y===5){
                                        if(correct===5)
                                        {
                                            document.getElementsByClassName("toast")[0].style.display = "block";
                                            document.getElementsByClassName("toast")[0].innerHTML = "Congrats";
                                            document.getElementsByClassName("toast")[0].style.color = "green";
                                            win = true;
                                        }
                                        else if(index===5)
                                        {
                                            document.getElementsByClassName("toast")[0].style.display = "block";
                                            document.getElementsByClassName("toast")[0].innerHTML = "The word is "+random;
                                            document.getElementsByClassName("toast")[0].style.color = "red";
                                        }
                                        clearInterval(interval)
                                        word = "";
                                        index++;
                                    }
                                },200)
                            }
                            else{
                                document.getElementsByClassName("toast")[0].style.display = "block";
                                document.getElementsByClassName("toast")[0].innerHTML = "Word Not in Dictionary";
                                document.getElementsByClassName("toast")[0].style.color = "red";
                                var timeout = setTimeout(()=>{
                                        document.getElementsByClassName("toast")[0].style.display = "none";
                                        clearTimeout(timeout);
                                },1000)
                            }
                        })
                        
                        
                    }
                    else if(w!=="keyboard_return" && w!=="backspace" && word.length<5)
                    {
                        word += w;
                        letter[(5*index)+word.length-1].innerHTML = word[word.length-1];
                    }
                    
                });
            })
    </script>
</body>
</html>